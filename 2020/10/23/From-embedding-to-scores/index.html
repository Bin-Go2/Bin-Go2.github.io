<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="From entity embeddings to edge scoresThe goal of training is to embed each entity in â„^D so that the embeddings of two entities are a good proxy to predict whether there is a relation of a certain typ">
<meta property="og:type" content="article">
<meta property="og:title" content="PyTorch-BigGraph ä»å®ä½“åµŒå…¥åˆ°è¾¹å¾—åˆ†">
<meta property="og:url" content="http://example.com/2020/10/23/From-embedding-to-scores/index.html">
<meta property="og:site_name" content="Bin&#39;s blog">
<meta property="og:description" content="From entity embeddings to edge scoresThe goal of training is to embed each entity in â„^D so that the embeddings of two entities are a good proxy to predict whether there is a relation of a certain typ">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-24T04:31:39.000Z">
<meta property="article:modified_time" content="2020-10-24T06:21:59.120Z">
<meta property="article:author" content="Bin">
<meta property="article:tag" content="PyTorch-BigGraph">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2020/10/23/From-embedding-to-scores/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>PyTorch-BigGraph ä»å®ä½“åµŒå…¥åˆ°è¾¹å¾—åˆ† | Bin's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Bin's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ä»Šæ—¥æ‘¸é±¼è¿›åº¦ï¼š 1/ âˆ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/23/From-embedding-to-scores/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Bin">
      <meta itemprop="description" content="æˆ‘ç†Šäººæ—æ°¸ä¸ä¸ºå¥´ï¼ï¼å¼å¼å¼ï¼ï¼ï¼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bin's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PyTorch-BigGraph ä»å®ä½“åµŒå…¥åˆ°è¾¹å¾—åˆ†
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-23 21:31:39 / Modified: 23:21:59" itemprop="dateCreated datePublished" datetime="2020-10-23T21:31:39-07:00">2020-10-23</time>
            </span>

          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="From-entity-embeddings-to-edge-scores"><a href="#From-entity-embeddings-to-edge-scores" class="headerlink" title="From entity embeddings to edge scores"></a>From entity embeddings to edge scores</h1><p>The goal of training is to embed each entity in â„^D so that the embeddings of two entities are a good proxy to predict whether there is a relation of a certain type between them.<br>è®­ç»ƒçš„ç›®çš„æ˜¯å°†æ¯ä¸ªå®ä½“åµŒå…¥åˆ°Dç»´çš„å‘é‡ç©ºé—´ä¸­ï¼Œä»¥ä¾¿ä¸¤ä¸ªå®ä½“çš„åµŒå…¥å¯ä»¥å¾ˆå¥½åœ°é¢„æµ‹å®ƒä»¬ä¹‹é—´æ˜¯å¦å­˜åœ¨æŸç§ç±»å‹çš„å…³ç³»ã€‚</p>
<p>To be more precise, the goal is to learn an embedding for each entity and a function for each relation type that takes two entity embeddings and assigns them a score, with the goal of having positive relations achieve higher scores than negative ones.<br>æ›´ç¡®åˆ‡åœ°è¯´ï¼ŒPBGçš„ç›®æ ‡æ˜¯å­¦ä¹ æ¯ä¸ªå®ä½“çš„åµŒå…¥å’Œæ¯ç§å…³ç³»ç±»å‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå®ä½“åµŒå…¥å¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªåˆ†æ•°ï¼Œç›®çš„æ˜¯ä½¿æ­£é¢å…³ç³»æ¯”è´Ÿé¢å…³ç³»è·å¾—æ›´é«˜çš„åˆ†æ•°ã€‚</p>
<blockquote>
<p>key point: å®ä½“-&gt;Dç»´å‘é‡ å…³ç³»-&gt;å‡½æ•°</p>
</blockquote>
<p>All the edges provided in the training set are considered positive instances. In order to perform training, a set of negative edges is needed as well. These are not provided by the user but instead generated by the system during training (Negative sampling), usually by fixing the left-hand side entity and the relation type and sampling a new right-hand side entity, or vice versa. This sampling scheme makes sense for large sparse graphs, where there is a low probability that edges generated this way are true positives edges in the graph.<br>è®­ç»ƒé›†ä¸­æä¾›çš„æ‰€æœ‰è¾¹è¢«è§†ä¸ºæ­£ä¾‹ã€‚ä¸ºäº†æ‰§è¡Œè®­ç»ƒï¼Œè¿˜éœ€è¦ä¸€äº›è´Ÿè¾¹ï¼ˆè´Ÿæ ·æœ¬ï¼‰ã€‚ è¿™äº›ä¸æ˜¯ç”±ç”¨æˆ·æä¾›çš„ï¼Œè€Œæ˜¯ç”±ç³»ç»Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç”Ÿæˆçš„ï¼ˆè´Ÿé‡‡æ ·ï¼‰ï¼Œé€šå¸¸æ˜¯é€šè¿‡å›ºå®šå·¦ä¾§å®ä½“å’Œå…³ç³»ç±»å‹å¹¶é‡‡æ ·æ–°çš„å³ä¾§å®ä½“ï¼Œåä¹‹äº¦ç„¶ã€‚ å¯¹äºå¤§çš„ç¨€ç–å›¾ï¼Œè¿™ç§é‡‡æ ·æ–¹æ¡ˆæ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œä»¥è¿™ç§æ–¹å¼ç”Ÿæˆçš„è¾¹ä¸ºå›¾ä¸­çš„æ­£ä¾‹çš„å¯èƒ½æ€§å¾ˆå°ã€‚</p>
<p>A priori, entity embeddings could take any value in â„^D. Although, in some cases (for example when restricting them to be within a certain ball, or when comparing them using cosine distance), their â€œangleâ€ will have greater importance than their norm.<br>å…ˆéªŒå®ä½“åµŒå…¥å¯ä»¥åœ¨Dç»´ç©ºé—´ä¸­å–ä»»ä½•å€¼ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œå½“å°†å®ƒä»¬é™åˆ¶åœ¨æŸä¸ªçƒå†…æˆ–ä½¿ç”¨ä½™å¼¦è·ç¦»è¿›è¡Œæ¯”è¾ƒæ—¶ï¼‰ï¼Œå®ƒä»¬çš„â€œè§’åº¦â€æ¯”èŒƒæ•°æ›´å…·æœ‰æ„ä¹‰ã€‚</p>
<p>Per-relation scoring functions, however, must be expressible in a specific form (the most common functions in the literature can be converted to such a representation). In the current implementation, they are only allowed to transform the embedding of one of the two sides, which is then compared to the un-transformed embedding of the other side using a generic symmetric comparator function, which is the same for all relations. Formally, for left- and right-hand side entities ğ‘¥ and ğ‘¦ respectively, and for a relation type ğ‘Ÿ, the score is:<center>ğ‘“ğ‘Ÿ(ğœƒğ‘¥,ğœƒğ‘¦)=ğ‘(ğœƒğ‘¥,ğ‘”ğ‘Ÿ(ğœƒğ‘¦))</center><br>where ğœƒğ‘¥ and ğœƒğ‘¦ are the embeddings of ğ‘¥ and ğ‘¦ respectively, ğ‘“ğ‘Ÿ is the scoring function for ğ‘Ÿ, ğ‘”ğ‘Ÿ is the operator for ğ‘Ÿ and ğ‘ is the comparator.</p>
<!-- $$f_{r}\left(\theta_{x}, \theta_{y}\right)=c\left(\theta_{x}, g_{r}\left(\theta_{y}\right)\right) -->
<p>ç„¶è€Œï¼Œå¯¹äºæ¯ä¸ªå…³ç³»çš„å¾—åˆ†è®¡ç®—å‡½æ•°ï¼Œå¿…é¡»ä»¥ç‰¹å®šçš„å½¢å¼è¡¨ç°å‡ºæ¥ï¼ˆæ–‡çŒ®ä¸­æœ€å¸¸è§çš„å‡½æ•°å¯ä»¥è½¬æ¢ä¸ºè¿™ç§è¡¨ç¤ºå½¢å¼ï¼‰ã€‚åœ¨ç›®å‰çš„å®ç°ä¸­ï¼Œåªå…è®¸å¯¹ä¸€ä¾§çš„å®ä½“è¿›è¡ŒåµŒå…¥è½¬æ¢ï¼Œé€šè¿‡ä½¿ç”¨é€šç”¨çš„å¯¹ç§°æ¯”è¾ƒå™¨å°†å…¶ä¸å¦ä¸€ä¾§æœªè½¬æ¢çš„å®ä½“åµŒå…¥è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·çš„æ“ä½œå¯¹äºæ‰€æœ‰çš„å…³ç³»ç±»å‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚å½¢å¼ä¸Šï¼Œåˆ†åˆ«å¯¹äºå·¦ä¾§å’Œå³ä¾§å®ä½“ğ‘¥å’Œ,ï¼Œä»¥åŠå¯¹äºå…³ç³»ç±»å‹ğ‘Ÿï¼Œå¾—åˆ†ä¸ºï¼šğ‘“ğ‘Ÿ(ğœƒğ‘¥,ğœƒğ‘¦)=ğ‘(ğœƒğ‘¥,ğ‘”ğ‘Ÿ(ğœƒğ‘¦)), å…¶ä¸­ï¼Œğœƒğ‘¥å’Œğœƒğ‘¦åˆ†åˆ«æ˜¯ğ‘¥å’Œğ‘¦çš„åµŒå…¥ï¼Œğ‘“ğ‘Ÿæ˜¯å…³ç³»ğ‘Ÿçš„è¯„åˆ†å‡½æ•°ï¼Œğ‘”ğ‘Ÿæ˜¯å…³ç³»rçš„ç®—å­ï¼Œğ‘æ˜¯æ¯”è¾ƒå™¨ã€‚</p>
<p>Under â€œnormalâ€ circumstances (the so-called â€œstandardâ€ relations mode) the operator is solely applied to the right-hand side entities. This is not the case when using dynamic relations. Applying the operator to both sides would oftentimes be redundant. Also, preferring one side over the other allows to break the symmetry and capture the direction of the edge.<br>åœ¨é€šå¸¸æƒ…å†µä¸‹(æˆ–è€…è¯´æ˜¯æ ‡å‡†çš„å…³ç³»æ¨¡å¼ä¸­)ï¼Œç®—å­ä»…ä»…æ˜¯é€‚ç”¨äºå³ä¾§å®ä½“ã€‚ä½†æ˜¯åœ¨PBGçš„åŠ¨æ€å…³ç³»ä¸­åˆ™ä¸æ˜¯è¿™æ ·ã€‚é€šå¸¸ï¼Œå°†ç®—å­è¿ç”¨åœ¨ä¸¤ä¾§çš„å®ä½“åµŒå…¥ä¸Šæ˜¯å¤šä½™çš„ï¼Œå¹¶ä¸”å€¾å‘äºé€‰æ‹©æŸä¸€ä¾§çš„ä¸¾åŠ¨å¯ä»¥å¾ˆå¥½çš„æ‰“ç ´å¯¹ç§°æ€§å¹¶ä¸”æ•æ‰åˆ°è¾¹çš„æ–¹å‘ã€‚</p>
<h2 id="Embeddings"><a href="#Embeddings" class="headerlink" title="Embeddings"></a>Embeddings</h2><p>Embeddings live in a ğ·-dimensional real space, where ğ· is determined by the dimension configuration parameter.<br>åµŒå…¥æ˜¯ä¸€ä¸ªğ·ç»´å®ç©ºé—´çš„å‘é‡ï¼Œå…¶ä¸­ğ·çš„å¤§å°ç”±é…ç½®å‚æ•°ç¡®å®šã€‚</p>
<p>Normally, each entity has its own embedding, which is entirely independent from any other entityâ€™s embedding. When using featurized entities however this works differently, and an entityâ€™s embedding will be the average of the embeddings of its features.<br>é€šå¸¸çš„ï¼Œæ¯ä¸€ä¸ªå®ä½“éƒ½æœ‰å±äºè‡ªå·±çš„å®Œå…¨å’Œå…¶ä»–å®ä½“åµŒå…¥ç‹¬ç«‹çš„åµŒå…¥ã€‚ç„¶è€Œï¼Œå½“ä½¿ç”¨ç‰¹å¾åŒ–çš„å®ä½“æ—¶ï¼Œæƒ…å†µæœ‰æ‰€ä¸åŒã€‚æ­¤æ—¶å®ä½“çš„åµŒå…¥ä¸ºå…¶ç‰¹å¾åµŒå…¥çš„å¹³å‡å€¼ã€‚</p>
<p>If the max_norm configuration parameter is set, embeddings will be projected onto the unit ball with radius max_norm after each parameter update.<br>å¦‚æœè®¾ç½®äº†max_normé…ç½®å‚æ•°ï¼Œåˆ™åœ¨æ¯æ¬¡æ›´æ–°å‚æ•°åï¼ŒåµŒå…¥å°†ä¼šè¢«æŠ•å½±åˆ°åŠå¾„ä¸ºmax_normçš„å•ä½çƒä¸Šã€‚</p>
<blockquote>
<p>ğŸ¤”ï¸ æš‚æ—¶æ²¡çœ‹æ‡‚ã€‚</p>
</blockquote>
<p>To add a new type of embedding, one needs to subclass the torchbiggraph.model.AbstractEmbedding class.<br>è¦æ·»åŠ ä¸€ç§æ–°å‹çš„åµŒå…¥ï¼Œéœ€è¦å°†torchbiggraph.model.AbstractEmbeddingç±»ä½œä¸ºå­ç±»ã€‚</p>
<blockquote>
<p>ğŸ¤”ï¸ æš‚æ—¶æ²¡çœ‹æ‡‚ã€‚</p>
</blockquote>
<h2 id="Global-embeddings"><a href="#Global-embeddings" class="headerlink" title="Global embeddings"></a>Global embeddings</h2><p>When the global_emb configuration option is active, each entityâ€™s embedding will be translated by a vector that is specific to each entity type (and that is learned at the same time as the embeddings).<br>å½“global_embé…ç½®å‚æ•°è®¾ç½®ä¸ºTrueçš„æ—¶å€™ï¼Œæ¯ä¸ªå®ä½“çš„åµŒå…¥å°†ä¼šè¢«è¡¨ç¤ºæˆä¸€ä¸ªå‘é‡ï¼Œè¯¥å‘é‡å¯¹äºæ¯ç§å®ä½“ç±»å‹éƒ½æ˜¯ç‰¹å®šçš„ã€‚ï¼ˆå¹¶ä¸”è¯¥å‘é‡æ˜¯ä¸åµŒå…¥åŒæ—¶å­¦ä¹ å¾—åˆ°çš„ï¼‰</p>
<blockquote>
<p>ğŸ¤”ï¸ æš‚æ—¶æ²¡çœ‹æ‡‚ã€‚</p>
</blockquote>
<h2 id="Operators"><a href="#Operators" class="headerlink" title="Operators"></a>Operators</h2><p>The operators that are currently provided are:<br>â€¢ none, no-op, which leaves the embeddings unchanged;<br>â€¢ translation, which adds to the embedding a vector of the same dimension;<br>â€¢ diagonal, which multiplies each dimension by a different coefficient (equivalent to multiplying by a diagonal matrix);<br>â€¢ linear, which applies a linear map, i.e., multiplies by a full square matrix<br>â€¢ affine, which applies a affine transformation, i.e., linear followed by translation.<br>â€¢ complex_diagonal, which interprets the ğ·-dimensional real vector as a ğ·/2-dimensional complex vector (ğ· must be even; the first half of the vector are the real parts, the second half the imaginary parts) and then multiplies each entry by a different complex parameter, just like diagonal.<br>å½“å‰æä¾›çš„ç®—å­æœ‰:<br>â€¢ æ— ï¼Œæ— æ“ä½œï¼Œä½¿åµŒå…¥ä¿æŒä¸å˜ï¼›<br>â€¢ å¹³ç§»ç®—å­ï¼Œå°†ç›¸åŒå°ºå¯¸çš„å‘é‡æ·»åŠ åˆ°åµŒå…¥ä¸­ï¼›<br>â€¢ å¯¹è§’ç®—å­ï¼Œå°†æ¯ä¸ªç»´åº¦ä¹˜ä»¥ä¸åŒçš„ç³»æ•°ï¼ˆç›¸å½“äºä¹˜ä»¥å¯¹è§’çŸ©é˜µï¼‰ï¼›<br>â€¢ çº¿æ€§ç®—å­ï¼Œè¿ç”¨ä¸€ä¸ªçº¿æ€§æ˜ å°„ï¼Œä¾‹å¦‚ï¼Œè®²åµŒå…¥å’Œä¸€ä¸ªå…¨æ–¹é˜µç‚¹ä¹˜ï¼›<br>â€¢ ä»¿å°„ç®—å­ï¼Œåº”ç”¨ä»¿å°„å˜æ¢ï¼Œå³çº¿æ€§å˜æ¢åå†è¿›è¡Œå¹³ç§»ï¼›<br>â€¢ å¤å¯¹è§’ç®—å­ï¼Œå°†Dç»´å®å‘é‡è½¬åŒ–ä¸ºD/2ç»´å¤çŸ¢é‡ï¼ˆğ·å¿…é¡»æ˜¯å¶æ•°ï¼›çŸ¢é‡çš„å‰åŠéƒ¨åˆ†æ˜¯å®æ•°éƒ¨åˆ†ï¼ŒååŠéƒ¨åˆ†æ˜¯è™šæ•°éƒ¨åˆ†ï¼‰ï¼Œç„¶åå°†æ¯ä¸ªé¡¹ä¹˜ä»¥ä¸åŒçš„å¤æ•°å‚æ•°ï¼Œå°±åƒå¯¹è§’ç®—å­ä¸€æ ·ã€‚</p>
<p>All the operatorsâ€™ parameters are learned during training.<br>è®­ç»ƒè¿‡ç¨‹ä¸­å°†å­¦ä¹ æ‰€æœ‰ç®—å­çš„å‚æ•°ã€‚</p>
<p>To define an additional operator, one must subclass the torchbiggraph.model.AbstractOperator class (or the torchbiggraph.model.AbstractDynamicOperator one when using dynamic relations; their docstrings explain what must be implemented) and decorate it with the torchbiggraph.model.OPERATORS.register_as() decorator (respectively the torchbiggraph.model.DYNAMIC_OPERATORS.register_as() one), specifying a new name that can then be used in the config to select that comparator. All of the above can be done inside the config file itself.<br>å¦‚æœè¦è‡ªå®šä¹‰æ–°çš„ç®—å­ï¼Œéœ€è¦å®ç°torchbiggraph.model.AbstractOperatorçš„å­ç±»ï¼ˆåŠ¨æ€å…³ç³»æƒ…å†µä¸‹å®ç°torchbiggraph.model.AbstractDynamicOperatorå­ç±»ï¼Œdocstringsè§£é‡Šäº†å¿…é¡»å®ç°ä»€ä¹ˆï¼‰å¹¶ä¸”åœ¨torchbiggraph.model.OPERATORS.register_as()è£…é¥°å™¨ä¸­æ³¨å†Œï¼ˆæˆ–è€…torchbiggraph.model.DYNAMIC_OPERATORS.register_as() ï¼‰æŒ‡å®šä¸€ä¸ªæ–°åç§°ï¼Œç„¶ååœ¨é…ç½®ä¸­ä½¿ç”¨è¯¥åç§°æ¥é€‰æ‹©æ¯”è¾ƒå™¨ã€‚ä¸Šè¿°æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥åœ¨é…ç½®æ–‡ä»¶å†…éƒ¨å®Œæˆã€‚</p>
<blockquote>
<p>ğŸ¤”ï¸ æš‚æ—¶æ²¡çœ‹æ‡‚ã€‚</p>
</blockquote>
<h2 id="Comparators"><a href="#Comparators" class="headerlink" title="Comparators"></a>Comparators</h2><p>The available comparators are:<br>â€¢ dot, the dot-product, which computes the scalar or inner product of the two embedding vectors;<br>â€¢ cos, the cos distance, which is the cosine of the angle between the two vectors or, equivalently, the dot product divided by the product of the vectorsâ€™ norms.<br>â€¢ l2, the negative L2 distance, a.k.a. the Euclidean distance (negative because smaller distances should get higher scores).<br>â€¢ squared_l2, the negative squared L2 distance.<br>å½“å‰æä¾›çš„æ¯”è¾ƒå™¨æœ‰ï¼š<br>â€¢ ç‚¹ä¹˜ï¼Œè®¡ç®—ä¸¤ä¸ªå®ä½“åµŒå…¥å‘é‡çš„æ ‡é‡æˆ–å†…ç§¯ï¼›<br>â€¢ ä½™å¼¦è·ç¦»ï¼Œä¸¤ä¸ªå®ä½“åµŒå…¥å‘é‡çš„ä½™å¼¦å¤¹è§’ï¼Œæˆ–è€…ç­‰æ•ˆçš„è¯´æ˜¯ dot(a,b)/(sqrt(a^2)*sqrt(a^2))<br>â€¢ è´ŸL2è·ç¦»ï¼Œåˆç§°æ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆä½¿ç”¨è´Ÿçš„äºŒèŒƒæ•°æ˜¯å› ä¸ºçœŸæ­£æ¯”è¾ƒçš„æ˜¯ä¸¤è€…çš„ç›¸ä¼¼åº¦ï¼Œè¾ƒå°çš„è·ç¦»åº”è·å¾—æ›´é«˜çš„åˆ†æ•°ï¼Œè¿™é‡Œçš„åˆ†æ•°å…¶å®å°±ç±»ä¼¼äºç›¸ä¼¼åº¦)<br>â€¢ L2çš„è´Ÿå¹³æ–¹è·ç¦»ã€‚</p>
<p>Custom comparators need to extend the torchbiggraph.model.AbstractComparator class (its docstring explains how) and decorate it with the torchbiggraph.model.COMPARATORS.register_as() decorator, specifying a new name that can then be used in the config to select that comparator. All of the above can be done inside the config file itself.<br>è‡ªå®šä¹‰æ¯”è¾ƒå™¨éœ€è¦æ‰©å±•torchbiggraph.model.AbstractComparatorç±»ï¼ˆå…¶æ–‡æ¡£å­—ç¬¦ä¸²è¯´æ˜æ–¹å¼ï¼‰ï¼Œå¹¶ä½¿ç”¨torchbiggraph.model.COMPARATORS.register_asï¼ˆï¼‰è£…é¥°å™¨å¯¹å…¶è¿›è¡Œä¿®é¥°ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªæ–°åç§°ï¼Œè¯¥åç§°éšåå¯åœ¨é…ç½®ä¸­ç”¨äºé€‰æ‹©è¯¥æ¯”è¾ƒå™¨ã€‚ä»¥ä¸Šæ‰€æœ‰æ“ä½œå‡å¯åœ¨é…ç½®æ–‡ä»¶æœ¬èº«ä¸­å®Œæˆã€‚</p>
<h2 id="Bias"><a href="#Bias" class="headerlink" title="Bias"></a>Bias</h2><p>If the bias configuration key is in use, then the first coordinate of the embeddings will act as a bias in the comparator computation. This means that the comparator will be computed on the last ğ·âˆ’1 entries of the vectors only, and then both the first entries of the two vectors will be added to the result.<br>å¦‚æœbiaså‚æ•°åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ä¸ºTrueï¼Œé‚£ä¹ˆåµŒå…¥çš„ç¬¬ä¸€ä¸ªåæ ‡å°†å……å½“æ¯”è¾ƒå™¨è®¡ç®—ä¸­çš„åç½®ã€‚è¿™æ„å‘³ç€æ¯”è¾ƒå™¨å°†ä»…åœ¨å‘é‡å¾—ç¬¬äºŒç»´åˆ°ç¬¬Dç»´ä¸Šè¿›è¡Œè®¡ç®—ï¼Œç„¶åå°†ä¸¤ä¸ªå‘é‡çš„ç¬¬ä¸€ç»´éƒ½ç›´æ¥è¢«æ·»åŠ åˆ°ç»“æœä¸­ã€‚</p>
<h2 id="Coherent-sets-of-configuration-parameters"><a href="#Coherent-sets-of-configuration-parameters" class="headerlink" title="Coherent sets of configuration parameters"></a>Coherent sets of configuration parameters</h2><p>While the parameters described in this chapter are exposed as uncoupled knobs in the configuration file (to more closely match the implementation, and to allow for more flexible tuning), some combinations of them are more sensible than others.<br>å°½ç®¡æœ¬ç« ä¸­æè¿°çš„å‚æ•°åœ¨é…ç½®æ–‡ä»¶ä¸­æ˜¾ç¤ºä¸ºæœªè€¦åˆçš„æ—‹é’®ï¼ˆä¸ºäº†æ›´è¿‘ä¼¼åŒ¹é…å®ç°æ•ˆæœï¼Œå¹¶å…è®¸æ›´çµæ´»çš„è°ƒä¼˜ï¼‰ï¼Œä½†å®ƒä»¬ä¸­çš„æŸäº›ç»„åˆæ¯”å…¶ä»–ç»„åˆæ›´åˆç†ã€‚</p>
<p>Apart from the default one, the following configuration has been found to work well: init_scale = 0.1, comparator = dot, bias = true, loss_fn = logistic, lr = 0.1.<br>é™¤é»˜è®¤é…ç½®å¤–ï¼Œè¿˜å‘ç°ä»¥ä¸‹é…ç½®å¯ä»¥æ­£å¸¸è¿è¡Œï¼šinit_scale = 0.1ï¼Œcomparator = dot, bias = true, loss_fn = logistic, lr = 0.1ã€‚</p>
<h2 id="Interpreting-the-scores"><a href="#Interpreting-the-scores" class="headerlink" title="Interpreting the scores"></a>Interpreting the scores</h2><p>The scores will be tuned to have different meaning and become more suitable for certain applications based on the loss function used during training. Common options include ranking what other entities may be related to a given entity, determining the probability that a certain relation exists between two given entities, etc.<br>æ ¹æ®è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨çš„æŸå¤±å‡½æ•°ï¼Œå¾—åˆ†å°†è¢«è°ƒæ•´ä¸ºå…·æœ‰ä¸åŒçš„å«ä¹‰ï¼Œå¹¶ä¸”å˜å¾—æ›´é€‚åˆæŸäº›ç‰¹å®šçš„åº”ç”¨ã€‚å¸¸è§é€‰é¡¹åŒ…æ‹¬å¯¹å…¶ä»–å®ä½“å¯èƒ½ä¸ç»™å®šå®ä½“ç›¸å…³çš„ç­‰çº§è¿›è¡Œæ’åã€ç¡®å®šä¸¤ä¸ªç»™å®šå®ä½“ä¹‹é—´å­˜åœ¨æŸç§å…³ç³»çš„å¯èƒ½æ€§ç­‰æŒ‡æ ‡ã€‚</p>
<p>æºåœ°å€ï¼š<br><a target="_blank" rel="noopener" href="https://torchbiggraph.readthedocs.io/en/latest/scoring.html">https://torchbiggraph.readthedocs.io/en/latest/scoring.html</a></p>

    </div>


    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PyTorch-BigGraph/" rel="tag"># PyTorch-BigGraph</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/23/Social-network/" rel="prev" title="ç¤¾äº¤ç½‘ç»œ">
      <i class="fa fa-chevron-left"></i> ç¤¾äº¤ç½‘ç»œ
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/10/27/PBG-I-O-format/" rel="next" title="PyTorch-BigGraph I/O æ ¼å¼">
      PyTorch-BigGraph I/O æ ¼å¼ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  
  


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#From-entity-embeddings-to-edge-scores"><span class="nav-number">1.</span> <span class="nav-text">From entity embeddings to edge scores</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Embeddings"><span class="nav-number">1.1.</span> <span class="nav-text">Embeddings</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Global-embeddings"><span class="nav-number">1.2.</span> <span class="nav-text">Global embeddings</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Operators"><span class="nav-number">1.3.</span> <span class="nav-text">Operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Comparators"><span class="nav-number">1.4.</span> <span class="nav-text">Comparators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bias"><span class="nav-number">1.5.</span> <span class="nav-text">Bias</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Coherent-sets-of-configuration-parameters"><span class="nav-number">1.6.</span> <span class="nav-text">Coherent sets of configuration parameters</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Interpreting-the-scores"><span class="nav-number">1.7.</span> <span class="nav-text">Interpreting the scores</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bin"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Bin</p>
  <div class="site-description" itemprop="description">æˆ‘ç†Šäººæ—æ°¸ä¸ä¸ºå¥´ï¼ï¼å¼å¼å¼ï¼ï¼ï¼</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Bin-Go2" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Bin-Go2" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:binzhangsam@gmail.com" title="E-Mail â†’ mailto:binzhangsam@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>

<div class="theme-info">
    <div class="powered-by"></div>
    <span class="post-count">å…±26.5kå­—</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
